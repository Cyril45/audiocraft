<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <title>AudioCraft MusicGen</title>
    <style>
        body {
            font-family: sans-serif;
            max-width: 700px;
            margin: 40px auto;
        }
        textarea, select, input, button {
            width: 100%;
            margin-top: 10px;
            padding: 8px;
        }
        button {
            font-size: 16px;
        }
    </style>
</head>
<body>
    <h1>üéµ AudioCraft MusicGen</h1>

    <label>Mod√®le</label>
    <select id="model">
        <option value="facebook/musicgen-small">small</option>
        <option value="facebook/musicgen-medium" selected>medium</option>
        <option value="facebook/musicgen-large">large</option>
        <option value="facebook/musicgen-small-stereo">small-stereo</option>
        <option value="facebook/musicgen-medium-stereo">medium-stereo</option>
        <option value="facebook/musicgen-large-stereo">large-stereo</option>
    </select>

    <label>Prompt</label>
    <textarea id="prompt" rows="4">
orchestral cinematic score, emotional build-up, epic ending
    </textarea>

    <label>Dur√©e (secondes)</label>
    <input type="number" id="duration" value="30" min="1" max="300" />

    <button onclick="generate()">üéß G√©n√©rer</button>

    <p id="status"></p>

    <script>
        async function generate() {
            const status = document.getElementById("status");
            status.innerText = "‚è≥ G√©n√©ration en cours‚Ä¶";

            const res = await fetch("/generate", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    model: document.getElementById("model").value,
                    prompt: document.getElementById("prompt").value,
                    duration: parseInt(document.getElementById("duration").value),
                }),
            });

            if (!res.ok) {
                status.innerText = "‚ùå Erreur";
                return;
            }

            const blob = await res.blob();
            const url = URL.createObjectURL(blob);

            const a = document.createElement("a");
            a.href = url;
            a.download = "musicgen.wav";
            a.click();

            status.innerText = "‚úÖ Audio g√©n√©r√©";
        }
    </script>
</body>
</html>
